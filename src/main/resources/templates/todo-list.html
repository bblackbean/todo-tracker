<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" th:href="@{/css/style.css}" />
    <title>ν•  μΌ λ©λ΅</title>
</head>
<body class="bg-light text-dark" id="main-body">
<div class="container mt-4">
    <h1>ν•  μΌ λ©λ΅</h1>

    <!-- λ‹¤ν¬ λ¨λ“ -->
    <div class="text-end mb-3">
        <button class="btn btn-outline-dark btn-sm" id="darkModeBtn" onclick="toggleDarkMode()">π™ λ‹¤ν¬ λ¨λ“</button>
    </div>

    <!-- κ²€μƒ‰ λ° μ •λ ¬ -->
    <h2>κ²€μƒ‰ λ° μ •λ ¬</h2>
    <form method="get" th:action="@{/view/todos}">
        <input type="text" name="keyword" placeholder="μ λ© κ²€μƒ‰"/>
        <span>μ •λ ¬</span>
        <select name="sortBy">
            <option value="id">ID</option>
            <option value="title">μ λ©</option>
            <option value="completed">μ™„λ£ μ—¬λ¶€</option>
        </select>
        <select name="order">
            <option value="asc">μ¤λ¦„μ°¨μ</option>
            <option value="desc">λ‚΄λ¦Όμ°¨μ</option>
        </select>
        <button type="submit">κ²€μƒ‰</button>
    </form>

    <!-- ν•  μΌ λ©λ΅ -->
    <h2>Todo List</h2>
    <table class="table table-bordered" id="todo-table">
        <thead>
        <tr>
            <th>ID</th>
            <th>μ λ©</th>
            <th>μ™„λ£ μ—¬λ¶€</th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="todo : ${todos}">
            <td th:text="${todo.id}"></td>
            <td>
                <!-- μ λ© ν΄λ¦­ μ‹ μμ • ν™”λ©΄μΌλ΅ μ΄λ™ -->
                <a th:text="${todo.title}" th:href="@{/view/todos/edit/{id}(id=${todo.id})}"></a>
            </td>
            <td>
                <!-- μ™„λ£ μ—¬λ¶€ μ²΄ν¬λ°•μ¤ -->
                <input type="checkbox" th:attr="data-id=${todo.id}"
                       th:checked="${todo.completed}" class="toggle-completed"/>
            </td>
            <td>
                <!-- μ‚­μ  λ²„νΌ -->
                <form th:action="@{/view/todos/delete/{id}(id=${todo.id})}" method="post" style="display:inline;">
                    <button type="submit" class="delete-btn" onclick="return confirm('μ •λ§ μ‚­μ ν•μ‹κ² μµλ‹κΉ?')">μ‚­μ </button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>

    <!-- νμ΄μ§• -->
    <div class="pagination">
    <span th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
        <a th:href="@{/view/todos(page=${i}, keyword=${param.keyword}, sortBy=${param.sortBy}, order=${param.order})}"
           th:text="${i + 1}"
           th:classappend="${i == currentPage} ? 'active' : ''"
           style="margin: 0 4px;"
        ></a>
    </span>
    </div>

    <!-- λ“±λ΅ -->
    <h2>ν•  μΌ λ“±λ΅</h2>
    <form method="post" th:action="@{/view/todos}" th:object="${todo}">
        <input type="text" th:field="*{title}" placeholder="ν•  μΌ μ λ©" required />
        <button type="submit">λ“±λ΅</button>
    </form>
</div>

<script th:src="@{/js/todo.js}"></script>
<!-- Bootstrap JS (Popper ν¬ν•¨) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
